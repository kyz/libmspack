#!/bin/sh
# test cabextract handles bad UTF-8 filenames
. test/testcase

"$cabextract" -l cabs/utf8-stresstest.cab >$actual
compare_with <<'EOF'
Viewing cabinet: cabs/utf8-stresstest.cab
 File size | Date       Time     | Name
-----------+---------------------+-------------
         0 | 12.03.1997 11:13:52 | Îºá½¹ÏƒÎ¼Îµ
         0 | 12.03.1997 11:13:52 | Â€
         0 | 12.03.1997 11:13:52 | à €
         0 | 12.03.1997 11:13:52 | ð€€
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | 
         0 | 12.03.1997 11:13:52 | ß¿
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | íŸ¿
         0 | 12.03.1997 11:13:52 | î€€
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ô¿¿
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ 
         0 | 12.03.1997 11:13:52 | ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ 
         0 | 12.03.1997 11:13:52 | ï¿½ ï¿½ ï¿½ ï¿½ 
         0 | 12.03.1997 11:13:52 | ï¿½ ï¿½ 
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | x
         0 | 12.03.1997 11:13:52 | x
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ß¿
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï¿½
         0 | 12.03.1997 11:13:52 | ï·ï·‘ï·’ï·“ï·”ï·•ï·–ï·—ï·˜ï·™ï·šï·›ï·œï·ï·žï·Ÿï· ï·¡ï·¢ï·£ï·¤ï·¥ï·¦ï·§ï·¨ï·©ï·ªï·«ï·¬ï·­ï·®ï·¯"|
         0 | 12.03.1997 11:13:52 | ðŸ¿¾ðŸ¿¿ð¯¿¾ð¯¿¿ð¿¿¾ð¿¿¿ñ¿¾ñ¿¿ñŸ¿¾ñŸ¿¿ñ¯¿¾ñ¯¿¿ñ¿¿¾ñ¿¿¿ò¿¾ò¿¿

All done, no errors.
EOF

read status < $status && test "x$status" = xsuccess
